<font size="4">

# java对象

by 菲尼莫斯 2019年3月14日

---

## 基本

* new 一个类的过程：

    1. 加载：由类加载器完成，找到对应的字节码，创建一个Class对象

    2. 链接：验证类中的字节码，为静态域分配空间

    3. 初始化：如果该类有父类，则对其初始化，执行静态初始化器和静态初始化块

* 内部类与外部类：
    * 内部类需要依赖于外部类存在（因为内部类中会引用外部类中的动态数据）
    * 内部类创建时必须要有一个明确的外部类`InClass c = new OutClass().new InClass();`
    * 静态内部类比较特殊，只能引用外部类中的静态成员，因此也可以直接构造`StaticINClass = new OutClass.InClass();`

## 面向对象的特性

### 抽象

* 忽略与当前目标无关的方面，只关注与当前目标有关的内容

> 如将代码中重复的或具体的部分提取为一个组件（抽象为一个对象）

* 抽象类abstract不能实例化，只能被用于extends

### 封装

* 将抽象对象的数据和数据操作的方法进行隐蔽

* 对外提供接口给使用者，使用者不必知道内部实现细节和存储细节

* 将设计者和使用者分开

### 继承

* 子类可以获得父类的所有**方法**和**变量**

* 子类可以修改继承的方法和新增方法

* 解决可重用性，提高编码效率和可维护性

* 一个子类只能继承一个父类（**单继承**）

* final类不能继承

### 多态

1. 子类能够响应发送给父类的同名消息

2. 子类可以以与父类不同的行为响应该消息

3. 该特性主要是通过子类覆盖父类方法来实现的 (实现接口、@Overwrite)

4. 在构造函数中调用多态方法会出现隐患

更多详见：/code/java/ExtendsTest.java

## 权限相关

* 默认（包保护）：只能被同一包的方法访问（不同包的子类无法访问）

* public：可以被任意方法访问

* protected：只可被本类及其子类访问

* private：只可以被本类的方法访问（子类无法访问），因此默认是final的无法覆盖

## 特殊关键字

* static：静态成员变量（类变量，可在实例间共享，只有一个值）
    * 可以在类中用 `static {}` 编写一个静态块（静态构造函数），该块会在类加载时执行其中的代码。

* transient：非序列化变量，不进行保存

* volatile：共享变量
    * 可以禁止指令的重排序（即编译器或处理器为了提高运行效率而对没有关联的代码进行重排序）
    * 可以保证变量的改变对所有线程可见（java虚拟机中每个线程都有自己的缓存内存，volatile变量改变时会刷新所有线程的缓存）
    * volatile是轻量级并发控制，不能代替synchronized（无法解决变量的原子性）

* abstract：抽象方法

* native：集成java代码和其他语言代码

* synchronized：控制多个并发线程对共享数据的访问

* default：在接口中声明一个默认方法，当两个接口中有相同的默认方法时必须进行方法重写

## 方法

* this指向了类本身，可以通过this.访问自身属性，使用this()直接调用类中重载的构造方法

* supper指向了父类，可以通过supper.访问父类属性，使用supper()调用父类的构造方法

* **子类的构造方法中必然会调用父类的构造方法，并且必须在第一条语句调用**
    * **父类的无参构造函数可以在第一行省略，编译器会自动调用**

* final实例变量（普通变量）需要在构造方法执行结束前完成初始化

* 子类中的属性会**隐藏**父类中的同名属性
    * 此时只有继承到的方法可以显式访问被隐藏的属性

* 子类中的方法会**覆盖**父类中的同名方法
    * 子类的方法不能比父类的更严格，如public方法不能变为private方法
    * static 和 final 方法不能覆盖
    * 依然可以使用 supper 访问被覆盖的方法

* 抽象方法abstract只有抽象类才能包含，必须被重写（覆盖），该做法规定了子类的规范

## Object类

* public final static Class getClass()、toString()

* public boolean equals(Obj obj)：可重写自定义如何比较，默认比较两个指针是否指向同一处；

* “==”运算符在对对象使用时，也判断**指针**是否指向同一处

* clone()：返回对象的副本（重新申请的对象空间）
    * 默认为protected方法，需要重写为public，才能有效调用
    * 使用该功能需要implement Cloneable接口

* hashCode()：对象的唯一标示hash值

* protected finalize()：可重写，会在jvm资源回收时调用，通常用作回收对象同时时的资源释放操作

## 泛型

更多详见 /code/java/GenericTest.java

## 接口

* 只规定方法名和参数列表及返回类型

* 只能包含基本数据类型的成员变量，且**默认为static和final**

* 方法默认是public

* 常用接口举例：writable（可写，需实现写方法）、readable（可读，需实现读方法）

</font>
