<font size="4">

# java垃圾回收

by 菲尼莫斯 2019年3月14日

---

## 回收对象

* 离开了作用域的对象

* 无引用指向的对象

## 可达性分析算法

* 以一个根节点（GC Root）开始，进行引用搜索，形成一条引用链，若一个节点与根节点不存在引用链，则将该节点视为垃圾

* 可以作为根节点的对象为：虚拟机栈或方法栈中引用的对象、方法区的静态属性和常量引用的对象

* 引用类型分为：强引用（new直接引用）、软引用（数组引用等，在内存溢出前一直存在）、弱引用（类似于软引用，会在第二次垃圾回收时回收）、虚引用（类似于软引用，但会被直接回收且无法访问）

* 标记-清除算法：每次先标记出需要回收的内存，在清理时清除标记的内容，容易产生内存碎片
    * 复制算法改进：每次清理前，将未标记的对象复制到一块干净的内存，一次性清理以前已使用的全部内存，但会是内存使用率降低
    * 标记整理算法改进：在标记完成后将存活对象都向内存的一端移动
    * 分代收集算法：根据对象的存活时间划分出永久代（常量、类描述）、老年代和新生代区域，从而针对其特点采用不同的垃圾收集算法（新生代：采用多块内存区域的复制算法，老年代采用标记整理算法）

## 机制

* 通过垃圾收集器**周期性**地释放无用对象的内存

* 内存不会泄露但其他资源可能会泄露

* 在自动垃圾回收前系统会自动调用对象的finalize()方法，用于释放资源

* 多对象回收的finalize()方法是随机无次序执行的

* 垃圾收集器自动扫描对象的动态内存区，对无用对象进行标记

* 垃圾收集器是一个后台守护线程

</font>